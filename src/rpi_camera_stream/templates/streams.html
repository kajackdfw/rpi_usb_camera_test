{% extends "base.html" %}

{% block title %}Camera Streams{% endblock %}

{% block content %}
<div class="flex flex-col items-center">
    <h1 class="text-2xl font-light mb-6 text-gray-800 dark:text-gray-100">
        Raspberry Pi Camera Stream
    </h1>

    <div class="bg-slate-200 dark:bg-slate-800 rounded-lg p-3 shadow-lg">
        <img id="stream"
             src="/video_feed"
             alt="Camera Stream"
             class="max-w-full h-auto rounded">
    </div>

    <div class="mt-5 flex gap-3">
        <button onclick="location.href='/api/snapshot'"
                class="px-5 py-2.5 bg-primary hover:bg-primary-hover text-white rounded transition-colors text-sm font-medium">
            Snapshot
        </button>
    </div>

    <div id="status" class="mt-4 text-sm text-gray-500 dark:text-gray-400">
        MJPEG Stream
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    const img = document.getElementById('stream');
    const status = document.getElementById('status');

    img.onload = function() {
        status.textContent = 'Connected';
        status.className = 'mt-4 text-sm text-green-500';
    };

    img.onerror = function() {
        status.textContent = 'Disconnected - Retrying...';
        status.className = 'mt-4 text-sm text-gray-500 dark:text-gray-400';
        setTimeout(() => {
            img.src = '/video_feed?' + Date.now();
        }, 2000);
    };
</script>
{% endblock %}
